#!/bin/bash

# | ************************************************************************************* #
# |
# |  This application prepares the data file to be wrangled by neatdata. 
# |
# |  Try:  ( prepare -f datafile.csv | filter )
# |
# |  This application determines the structure of the data file, including separation and quotes
# |
# | ************************************************************************************* #


source ./neat_functions


## Preparing arguments ######
num=0
while [[ "$1" != "" ]] && [[ "$num" -lt 5 ]]; do
    case $1 in
        -s | --separator )      shift
                                sep=$1
                                shift
                                ;;
        -q | --quote )   shift
                                quote=$1
                                shift
                                ;;
     esac
     num=$(( $num + 1 ))
done

filename=$1

if [[ "$quote" == "" ]] 
then
    quote=\"
fi

if [[ "$sep" == "" ]] 
then
    sep=\^$quote\|$quote,$quote\|$quote\$	
fi

if [[ "$filename" == "" ]]
then
    echo "ERROR - No filename"
    exit 1
fi
############################################################

cat $filename

